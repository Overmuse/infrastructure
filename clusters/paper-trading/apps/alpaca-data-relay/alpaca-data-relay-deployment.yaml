apiVersion: v1
kind: ConfigMap
metadata:
  name: alpaca-data-relay-cm
data:
  KAFKA__BOOTSTRAP_SERVERS: pkc-ep9mm.us-east-2.aws.confluent.cloud:9092
  KAFKA__GROUP_ID: alpaca-data-relay
  KAFKA__SECURITY_PROTOCOL: SASL_SSL
  ALPACA__ACCOUNT_UPDATES: "true"
  ALPACA__TRADE_UPDATES: "true"
  SENTRY__ADDRESS: https://200a764c48b1425595284ae6cb226303@o515476.ingest.sentry.io/5723647
  RUST_LOG: debug
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: alpaca-data-relay-deployment
spec:
  selector:
    matchLabels:
      app: alpaca-data-relay
  replicas: 1
  template:
    metadata:
      labels:
        app: alpaca-data-relay
    spec:
      containers:
      - name: alpaca-data-relay
        image: 799439856592.dkr.ecr.us-east-1.amazonaws.com/alpaca-data-relay:v1.0.1 # {"$imagepolicy": "flux-system:alpaca-data-relay"}
        envFrom:
        - configMapRef:
            name: alpaca-cm
        - configMapRef:
            name: alpaca-data-relay-cm
        - configMapRef:
            name: kafka-cm
        - secretRef:
            name: kafka-secret
        - secretRef:
            name: alpaca-secret
